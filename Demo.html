<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head> <body>

<!-- BEGIN /xnat-templates/screens/XIViewer.vm -->



<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/closure-library/closure/goog/css/menu.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/closure-library/closure/goog/css/menuitem.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/closure-library/closure/goog/css/menuseparator.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/closure-library/closure/goog/css/menubutton.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/closure-library/closure/goog/css/custombutton.css">

<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/genericslider.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/scrollablecontainer.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/zippynode.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/zippytree.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/thumbnail.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/thumbnailgallery.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/resizable.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/tabs.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/ziptabs.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/lib/moka/ui/css/slideinmenu.css">

<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/viewbox.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/modal.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/thumbnail.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/thumbnailgallery.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/viewboxhandler.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/layouthandler.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/layout.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/xyzvlayout.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/conventional.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/fourup.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/plane.css">
<link type="text/css" rel="stylesheet" href="src/main/scripts/viewer/xiv/ui/css/progressbarpanel.css">


<script src="src/main/scripts/viewer/xiv/sample-data/XNAT_IMAGE_VIEWER_DEMO_DATA.js"></script>

<!-- lib -->
<script src="src/main/scripts/viewer/xiv/lib/closure-library/closure/goog/base.js"></script>
<script src="src/main/scripts/viewer/xiv/lib/X/xtk-deps.js"></script>
<script src="src/main/scripts/viewer/xiv/lib/_custom/X/xtk-custom-deps.js"></script>
<script src="src/main/scripts/viewer/xiv/lib/gxnat/gxnat-deps.js"></script>
<script src="src/main/scripts/viewer/xiv/lib/moka/moka-deps.js"></script>
<!-- lib -->

<!-- xiv -->
<script src="src/main/scripts/viewer/xiv/xiv-deps.js"></script>
<!-- xiv -->


<!-- /XIViewer.vm -->


</head>



</body>

<script>

goog.require('gxnat');
goog.require('xiv');
goog.require('xiv.ui.Modal');


var dataPath = '';
var modalState = 'popup';
var imagePath = 'images/viewer/';




// NOTE: serverRoot is a global,
// it will adjust accordingly.

function launchXImgView(opt_dataPath, opt_modalState) {
    window.console.log('VIEWER LAUNCH', opt_dataPath);
    window.console.log('(window state)', modalState, opt_modalState);
    window.console.log('(serverRoot)', serverRoot); 
    //window.console.log('(mode)', mode);
    window.console.log('dataPath', dataPath);
    window.console.log('imagePath', imagePath);



    xiv.loadCustomExtensions();

    xiv.adjustDocumentStyle();


    if (goog.isString(opt_modalState)){ modalState = opt_modalState};

    window.console.log("MODAL STATE", modalState);
    var XnatImageViewer = new xiv(modalState, serverRoot,  
			      gxnat.Path.getQueryPrefix(serverRoot),
			      imagePath);

    XnatImageViewer.setModalType(xiv.ui.Modal);

    XnatImageViewer.createModal();


    XnatImageViewer.loadExperiment(dataPath || opt_dataPath, function() {
        XnatImageViewer.loadProjectTree();
    });

 
    XnatImageViewer.showModal();
};





//-----------------
// Live-Windowed launch
//-----------------
if (modalState === 'windowed'){
    dataPath = 'projects/$om.getProject()/subjects/'
    dataPath += '$om.getSubjectId()/experiments/$om.getId()';
}


//-----------------
// Live-Popup launch
//-----------------
else if (modalState === 'popup'){
    //dataPath = window.document.body.custom;
    //alert(dataPath);
    serverRoot = '';

   /**
    window.onload = function(){
        window.console.log(document.getElementsByClassName('xiv-ui-modal'));
        launchXImgView();
    }
    */
}

</script>


</html>
